---
title: "Easy R Markdown Reporting with {chronicle}"
author: "Philippe Heymans Smith - @pheymanss"
output:
  xaringan::moon_reader:
    css: [useR, useR-fonts]
    lib_dir: libs
    nature:
      ratio: '16:9'
      slideNumberFormat: '%current%' 
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r, echo=FALSE}
options(knitr.duplicate.label = "allow")
xaringanExtra::use_tile_view()
xaringanExtra::use_webcam()
```

```{css, echo=FALSE}
.white{
    color: white;
}

a:link {
  color: white;
   text-decoration: underline;
  font-size: 20px;
}


a:visited {
  color: white;
  text-decoration: underline;
  font-size: 20px;
}

a:hover {
  background-color: yellow;
}

.code{
  background-color: #d9d9d9;
  color: black;
  font-family: Source Code Pro
}

.warning{
  color: red;
  font-weight: bold;
  font-size: 20px;
}

.highlight{
  background-color: gold
}
```

## chronicle
An opinionated assistant that makes R Markdown reports for you.

--

```{r, message=FALSE}
library(chronicle)

demo_report <-
  add_table(table = head(iris),
            table_title = "A glimpse at the iris dataset",
            html_table_type = "kable") %>%
  add_raincloud(dt = iris,
                value = "Sepal.Length",
                groups = "Species") %>% 
  add_text(text = c('Add text between elements like these!',
                    stringi::stri_rand_lipsum(1))) %>%
  add_boxplot(dt = palmerpenguins::penguins, 
              value = 'body_mass_g',
              groups = 'island',
              split_groups_by = 'sex')
```

--

```{r, message=FALSE, warning=FALSE, eval=FALSE}
render_report(demo_report)
```

---

### supported elements

- Bar plots
- Box plots
- Code chunks
- Density plots
- dygraphs
- Histograms
- Images
- Line plots
- Plain tex
- Raincloud plots
- Scatter plots
- Tables (kable and DT.js)
- Violin plots

---

```{r, message=FALSE, warning=FALSE, eval=FALSE}
demo_report
```

--

```{r, message=FALSE, warning=FALSE, echo=FALSE, fig.alt='The variable demo_report reveals itself to be a character string containing all the usual content you would expect looking at the content of an R Markdown file: backticks and brackets opening and closing R code chunks, numeral symbols specifying headers, and plain text inbetween code chunks.'}
knitr::include_graphics('demo_report.png', dpi = 250)
```

---

## make_   family of functions

```{r, echo=TRUE, message=FALSE, warning=FALSE, eval=FALSE, fig.alt='An html widget embedded into the presentation, containing three separated groups of interactive boxplots, one group for each species. Inside each group, there are three box plots, one for female, male and NA sex values.'}
chronicle::make_boxplot(dt = palmerpenguins::penguins,
                        value = 'body_mass_g',
                        groups = 'island',
                        split_groups_by = 'sex',
                        jitter = TRUE,
                        plot_palette_generator = 'viridis',
                        static = FALSE)
```

--

```{r, warning=FALSE, echo=FALSE}
widgetframe::frameWidget(chronicle::make_boxplot(dt = palmerpenguins::penguins,
                                                 value = 'body_mass_g',
                                                 groups = 'island',
                                                 split_groups_by = 'sex',
                                                 jitter = TRUE,
                                                 plot_palette_generator = 'viridis',
                                                 static = FALSE),
                         width = '100%', 
                         height = 270)
```

---

## make_ family of functions

```{r, echo=TRUE, message=FALSE, warning=FALSE, eval=FALSE, fig.alt='An html widget embedded into the presentation, containing three separated groups of interactive boxplots, one group for each species. Inside each group, there are three box plots, one for female, male and NA sex values.'}
chronicle::make_boxplot(dt = palmerpenguins::penguins,
                        value = 'body_mass_g',
                        groups = 'island',
                        split_groups_by = 'sex',
                        jitter = TRUE,
                        plot_palette_generator = 'viridis',
                        static = FALSE)
```


.warning[But please do learn ggplot2!]

---

### Rendering
```{r, eval=FALSE, message=FALSE, warning=FALSE}
render_report(report = director_report, 
              output_format = 'word_document',
              title = 'Director report',
              filename = 'director_obs', 
              docx_reference_file = 'institution_template.docx')
```
--
```{r, eval=FALSE, message=FALSE, warning=FALSE}
render_report(report = niche_report, 
              output_format = 'pagedown',
              filename = 'Niche Team')
```
--
```{r, eval=FALSE, message=FALSE, warning=FALSE}
render_report(report = lab_report, 
              output_format = c('rmdformats','pdf')
              title = paste('Lab Observations', Sys.Date()), 
              filename = paste('lab_observations', Sys.Date()))
```


---

### Rendering Options

- File name (default is a generic name with date)
- Title and author
- Include date
- Directory for the output
- Output format (several at a time)
- Keep the .Rmd file it wrote
- Render the report or not
- Include table of contents (when formats allow it)
- Table of content depth
- Number the sections
- Figure width and height
- Plot pallete
- Plot palette generator (viridis)
- Themes
  - html_theme
  - rmdformats
  - prettydoc
  - Microsoft Word and PowerPoint reference files

--- 
---

## Output formats

.pull-left[
### Interactive
-   bookdown
-   html_document
-   html_notebook
-   ioslides
-   prettydoc
-   rmdformats (default)
-   slidy_presentation
-   tufte_html
]

.pull-right[
### Static
-   github_document
-   pagedown
-   pdf
-   powerpoint_presentation
-   rolldown
-   tufte_handout
-   word_document
]
---

## report_columns()
```{r, eval=FALSE, message=FALSE, warning=FALSE}
report_columns(palmerpenguins::penguins)
```

--
```{r, eval=FALSE, message=FALSE, warning=FALSE}
report_columns(palmerpenguins::penguins, 
               by_column = 'species')
```

---

## Limitations

--

1. Plotly's limitations 
--
(my ignorance of plotly solutions?)
--

  - Compatibility of custom geoms.
--

  - Data sizes translate to report file sizes. 
--

      - If over 10,000 rows, it rolls back into static ggplot2
--
(ugly line on the sand, sorry)
--

2. Unsupported formats:
--

  - xaringan
--

  - flexdashboard
--

  - rticles 
--
(please don't)
--

3. Anything that is not currently supported
--
: .code[add_code()]

--

```{r eval=FALSE}
add_code(code = 'corrplot::corrplot(cor(mtcars))', eval = TRUE)
```

--

```{r echo=FALSE}
substring(add_code(code = 'corrplot::corrplot(cor(mtcars))', eval = TRUE),3)
```




---


class: chapter-slide

# Thank you!

.white[
Reach out [@pheymanss](https://twitter.com/pheymanss)

- Package repository - https://github.com/pheymanss/chronicle

- Full showcase of chronicle elements - https://pheymanss.github.io/chronicle-demos/showcase

]